import requests
from bs4 import BeautifulSoup
from urllib.parse import urlparse, unquote

def extract_business_url(profile_url):
    response = requests.get(profile_url)
    soup = BeautifulSoup(response.text, 'html.parser')

    # Select all links with href starting with "/biz_redir"
    business_links = soup.select('[href^="/biz_redir"]')

    business_urls = set()
    for business_link in business_links:
        href = business_link.get('href')
        # Parse the href to get the actual business URL and remove unwanted text
        parsed_url = urlparse(href)
        business_url = unquote(parsed_url.query.split('=')[1]).split('&')[0]
        business_urls.add(business_url)

    return list(business_urls)

# Example usage with a list of profile URLs
profile_urls = [
    "https://www.yelp.com/biz/s-and-e-painting-tacoma-4", "https://www.yelp.com/biz/ab-roofing-and-painting-aberdeen", "https://www.yelp.com/biz/marquez-roofing-tacoma-2", "https://www.yelp.com/biz/angels-nw-painting-and-remodeling-lakewood", "https://www.yelp.com/biz/destiny-construction-university-place", "https://www.yelp.com/biz/jack-jack-of-trades-olympia-2", "https://www.yelp.com/biz/bavarian-painting-lacey", "https://www.yelp.com/biz/cobra-painting-edgewood-2", "https://www.yelp.com/biz/priced-right-painting-tacoma", "https://www.yelp.com/biz/robs-painting-service-spanaway", "https://www.yelp.com/biz/prosser-maintenance-and-handyman-services-tacoma", "https://www.yelp.com/biz/honor-roll-painting-olympia", "https://www.yelp.com/biz/spraying-northwest-puyallup-3", "https://www.yelp.com/biz/e-and-m-drywall-and-painting-tacoma", "https://www.yelp.com/biz/cpr-olympia-4", "https://www.yelp.com/biz/hooper-home-maintenance-technician-milton", "https://www.yelp.com/biz/tah-shay-cleaning-and-interior-painting-services-port-orchard", "https://www.yelp.com/biz/rj-painting-puyallup-2", "https://www.yelp.com/biz/west-painting-enumclaw", "https://www.yelp.com/biz/lacey-handyman-lacey", "https://www.yelp.com/biz/south-sound-handyman-spanaway-2", "https://www.yelp.com/biz/a-rightway-painting-tenino-3", "https://www.yelp.com/biz/color-coated-painting-olympia", "https://www.yelp.com/biz/perfect-reflections-painting-shelton", "https://www.yelp.com/biz/painting-plus-olympia", "https://www.yelp.com/biz/affordable-pro-services-seattle", "https://www.yelp.com/biz/top-coat-painting-professionals-puyallup", "https://www.yelp.com/biz/college-pro-painters-seattle-2", "https://www.yelp.com/biz/scandinavian-painting-systems-bothell", "https://www.yelp.com/biz/major-paint-plus-hoquiam", "https://www.yelp.com/biz/nw-pro-services-olympia-2", "https://www.yelp.com/biz/ware-painting-company-tacoma-3", "https://www.yelp.com/biz/sharpest-painting-lacey", "https://www.yelp.com/biz/residential-paints-and-renovations-olympia-3", "https://www.yelp.com/biz/paintbox-painting-lacey-2", "https://www.yelp.com/biz/js-signature-painting-lacey", "https://www.yelp.com/biz/agmsinc-tacoma", "https://www.yelp.com/biz/pro-cover-roofing-aberdeen-8", "https://www.yelp.com/biz/bear-claw-painting-and-wall-covering-onalaska", "https://www.yelp.com/biz/inland-coast-painting-hoquiam-3", "https://www.yelp.com/biz/tornados-painting-yelm-2", "https://www.yelp.com/biz/sc-pro-painting-edmonds", "https://www.yelp.com/biz/bal-handyman-24-7-lacey", "https://www.yelp.com/biz/professional-install-services-king-county", "https://www.yelp.com/biz/premier-painting-llc-olympia", "https://www.yelp.com/biz/simply-installations-auburn-2", "https://www.yelp.com/biz/jps-painting-company-university-place", "https://www.yelp.com/biz/pnw-premier-enterprises-lacey", "https://www.yelp.com/biz/mcbride-construction-resources-burien-2", "https://www.yelp.com/biz/skyline-painting-lacey-2", "https://www.yelp.com/biz/lsr-commercial-cleaning-services-olympia-3", "https://www.yelp.com/biz/barraza-northwest-drywall-and-paint-services-federal-way-2", "https://www.yelp.com/biz/2-hats-painting-tacoma-2", "https://www.yelp.com/biz/a-personal-touch-painting-maintenence-and-remodeling-olympia", "https://www.yelp.com/biz/andys-affordable-work-buckley-2", "https://www.yelp.com/biz/a-98-painting-olympia", "https://www.yelp.com/biz/northwest-construction-cooperative-olympia", "https://www.yelp.com/biz/a-s-e-painting-olympia", "https://www.yelp.com/biz/pro-cover-roofing-rochester", "https://www.yelp.com/biz/rainier-home-improvements-tacoma", "https://www.yelp.com/biz/kuster-homes-and-remodeling-tumwater", "https://www.yelp.com/biz/modern-builders-tacoma", "https://www.yelp.com/biz/final-finish-general-contracting-renton", "https://www.yelp.com/biz/jt-painting-company-tumwater", "https://www.yelp.com/biz/jstar-services-lacey", "https://www.yelp.com/biz/puget-sound-paint-and-design-tacoma", "https://www.yelp.com/biz/valora-landscaping-and-painting-port-orchard", "https://www.yelp.com/biz/sunnyside-construction-tacoma", "https://www.yelp.com/biz/cutting-edge-painting-services-olympia", "https://www.yelp.com/biz/carrillos-landscaping-shelton-4", "https://www.yelp.com/biz/sea-tac-oly-painting-and-remodel-olympia-2", "https://www.yelp.com/biz/c-and-d-painting-spanaway", "https://www.yelp.com/biz/pronto-painting-renton", "https://www.yelp.com/biz/shays-painting-olympia", "https://www.yelp.com/biz/bertucci-painting-and-remodeling-centralia", "https://www.yelp.com/biz/flying-colors-painting-lacey-5", "https://www.yelp.com/biz/terra-brazil-renton-14", "https://www.yelp.com/biz/p-mart-pro-painting-university-place-3", "https://www.yelp.com/biz/lg-general-construction-rochester-5", "https://www.yelp.com/biz/fairbanks-paper-hanging-olympia", "https://www.yelp.com/biz/malcolms-pro-services-seattle", "https://www.yelp.com/biz/westpro-painting-olympia", "https://www.yelp.com/biz/rappisi-professional-painting-drywall-ruston-2", "https://www.yelp.com/biz/wet-works-olympia", "https://www.yelp.com/biz/bmg-painting-and-remodel-olympia", "https://www.yelp.com/biz/the-brush-masters-lakewood", "https://www.yelp.com/biz/cj-and-sons-construction-olympia", "https://www.yelp.com/biz/special-finish-painting-puyallup", "https://www.yelp.com/biz/legacy-painting-olympia-2", "https://www.yelp.com/biz/all-star-painting-services-olympia", "https://www.yelp.com/biz/freeland-painting-tacoma", "https://www.yelp.com/biz/g-and-g-construction-services-lakewood", "https://www.yelp.com/biz/j-linder-painting-olympia", "https://www.yelp.com/biz/garcias-roofing-and-construction-spanaway-2", "https://www.yelp.com/biz/college-pro-painters-olympia-olympia", "https://www.yelp.com/biz/ultimate-painting-lacey", "https://www.yelp.com/biz/precise-construction-services-everett-2", "https://www.yelp.com/biz/ketola-targus-painting-inc-tumwater-2", "https://www.yelp.com/biz/don-and-samantha-renovations-tumwater", "https://www.yelp.com/biz/west-exterior-construction-federal-way", "https://www.yelp.com/biz/jgc-services-tacoma", "https://www.yelp.com/biz/w-e-davis-olympia-2", "https://www.yelp.com/biz/proresults-painting-federal-way-3", "https://www.yelp.com/biz/simply-gutters-auburn", "https://www.yelp.com/biz/seattle-eco-painting-seattle", "https://www.yelp.com/biz/mr-coatings-roy", "https://www.yelp.com/biz/poly-salish-painters-shelton", "https://www.yelp.com/biz/reality-homes-tacoma-2", "https://www.yelp.com/biz/bibby-painting-company-university-place", "https://www.yelp.com/biz/marta-paint-works-seattle", "https://www.yelp.com/biz/rdj-olympia", "https://www.yelp.com/biz/360-painting-olympia", "https://www.yelp.com/biz/five-star-general-contractor-puyallup", "https://www.yelp.com/biz/the-paint-machine-shelton", "https://www.yelp.com/biz/premier-handyman-services-spanaway", "https://www.yelp.com/biz/montgomery-painting-olympia", "https://www.yelp.com/biz/elite-freedom-painters-olympia", "https://www.yelp.com/biz/simmons-and-daughters-olympia", "https://www.yelp.com/biz/four-seasons-painting-and-siding-tacoma", "https://www.yelp.com/biz/a-stroke-of-excellence-port-orchard", "https://www.yelp.com/biz/glr-general-painting-burien", "https://www.yelp.com/biz/oly-painting-company-olympia", "https://www.yelp.com/biz/daves-custom-painting-rochester", "https://www.yelp.com/biz/alberto-and-nicole-home-transformations-silverdale-2", "https://www.yelp.com/biz/topnotch-painting-seattle", "https://www.yelp.com/biz/morrow-drywall-yelm", "https://www.yelp.com/biz/proquality-construction-lakewood", "https://www.yelp.com/biz/all-in-one-painting-olympia", "https://www.yelp.com/biz/orca-paint-olympia-3", "https://www.yelp.com/biz/amazing-grace-painters-bainbridge-island", "https://www.yelp.com/biz/dirty-brush-enumclaw", "https://www.yelp.com/biz/all-season-painting-sumner-3", "https://www.yelp.com/biz/healthy-painting-seattle", "https://www.yelp.com/biz/pro-tech-painting-centralia", "https://www.yelp.com/biz/wheeler-painting-kent", "https://www.yelp.com/biz/ezs-painting-mossyrock-3", "https://www.yelp.com/biz/jerrys-painting-yelm", "https://www.yelp.com/biz/hirollerz-burien-2", "https://www.yelp.com/biz/elite-painting-pros-lakewood", "https://www.yelp.com/biz/lucatero-painting-yelm-2", "https://www.yelp.com/biz/epic-home-builders-tacoma", "https://www.yelp.com/biz/lvg-painting-yelm", "https://www.yelp.com/biz/pacificpro-painting-services-bonney-lake-3", "https://www.yelp.com/biz/casey-colors-painting-shelton", "https://www.yelp.com/biz/miles-plus-painting-olympia-2", "https://www.yelp.com/biz/top-grade-development-spanaway", "https://www.yelp.com/biz/l-and-l-family-painting-olympia-3", "https://www.yelp.com/biz/certapro-painters-of-tacoma-wa-university-place", "https://www.yelp.com/biz/olympia-spray-services-tumwater", "https://www.yelp.com/biz/pvy-construction-federal-way", "https://www.yelp.com/biz/gonzalez-painting-spanaway", "https://www.yelp.com/biz/hoeks-painting-olympia", "https://www.yelp.com/biz/obies-handyman-services-lakewood", "https://www.yelp.com/biz/finishing-effects-graham", "https://www.yelp.com/biz/mucio-pro-painting-seattle-2", "https://www.yelp.com/biz/capitol-painting-company-olympia-3", "https://www.yelp.com/biz/gbc-painting-and-drywall-tacoma", "https://www.yelp.com/biz/the-lone-painter-port-orchard", "https://www.yelp.com/biz/rc-painting-and-more-tumwater", "https://www.yelp.com/biz/d-schroeder-construction-hoquiam", "https://www.yelp.com/biz/sunderland-construction-auburn", "https://www.yelp.com/biz/shine-so-bright-cleaning-and-painting-services-tumwater", "https://www.yelp.com/biz/westcoast-painting-renton", "https://www.yelp.com/biz/gem-jobs-puyallup", "https://www.yelp.com/biz/denali-painting-tacoma", "https://www.yelp.com/biz/olympia-painting-company-olympia-3", "https://www.yelp.com/biz/before-and-after-painting-olympia", "https://www.yelp.com/biz/powerhouse-painting-olympia-2", "https://www.yelp.com/biz/unlimited-finish-pro-seattle-6", "https://www.yelp.com/biz/sj-paint-and-renovation-puyallup", "https://www.yelp.com/biz/pyroshield-of-washington-puyallup", "https://www.yelp.com/biz/all-painting-coatings-and-more-olympia", "https://www.yelp.com/biz/leo-general-contractor-lacey", "https://www.yelp.com/biz/coastal-painting-belfair-3"
]

for profile_url in profile_urls:
    business_urls = extract_business_url(profile_url)

    if business_urls:
        for url in business_urls:
            print(f'"{url}",')






