import requests
from bs4 import BeautifulSoup
from urllib.parse import urlparse, unquote

def extract_business_url(profile_url):
    response = requests.get(profile_url)
    soup = BeautifulSoup(response.text, 'html.parser')

    # Select all links with href starting with "/biz_redir"
    business_links = soup.select('[href^="/biz_redir"]')

    business_urls = set()
    for business_link in business_links:
        href = business_link.get('href')
        # Parse the href to get the actual business URL and remove unwanted text
        parsed_url = urlparse(href)
        business_url = unquote(parsed_url.query.split('=')[1]).split('&')[0]
        business_urls.add(business_url)

    return list(business_urls)

# Example usage with a list of profile URLs
profile_urls = [
    "https://www.yelp.com/biz/innovation-custom-painting-woodburn-2", "https://www.yelp.com/biz/pz-painting-and-contracting-clackamas-2", "https://www.yelp.com/biz/dreamhome-painting-salem", "https://www.yelp.com/biz/im-construction-hillsboro", "https://www.yelp.com/biz/chalio-fast-pro-construction-albany-2", "https://www.yelp.com/biz/ethan-darcey-painting-salem", "https://www.yelp.com/biz/master-touch-painting-salem-3", "https://www.yelp.com/biz/new-day-painting-mcminnville-3", "https://www.yelp.com/biz/e-and-d-paint-and-contracting-woodburn", "https://www.yelp.com/biz/cletos-painting-keizer-2", "https://www.yelp.com/biz/super-cool-painter-guy-and-construction-albany-2", "https://www.yelp.com/biz/pro-exterior-remodelers-woodburn-2", "https://www.yelp.com/biz/michael-angelo-exteriors-salem-3", "https://www.yelp.com/biz/drummond-kenneth-co-salem", "https://www.yelp.com/biz/stom-painters-albany", "https://www.yelp.com/biz/speedy-paint-services-gresham", "https://www.yelp.com/biz/jacobs-ladder-paint-portland-2", "https://www.yelp.com/biz/aiden-ryan-designs-st-helens", "https://www.yelp.com/biz/colortech-enterprises-mount-angel", "https://www.yelp.com/biz/double-diamond-painting-salem", "https://www.yelp.com/biz/laser-line-salem", "https://www.yelp.com/biz/yahweh-painting-and-carpentry-wilsonville-2", "https://www.yelp.com/biz/newton-painting-and-property-maintenance-salem", "https://www.yelp.com/biz/jju-maintenance-salem-3", "https://www.yelp.com/biz/nw-painting-construction-and-remodel-keizer", "https://www.yelp.com/biz/jb-coloringbrush-painting-woodburn-2", "https://www.yelp.com/biz/asap-pro-painting-portland", "https://www.yelp.com/biz/pacific-bath-portland", "https://www.yelp.com/biz/emberly-home-portland", "https://www.yelp.com/biz/nw-home-exteriors-lake-oswego-6", "https://www.yelp.com/biz/n-w-precision-exteriors-silverton", "https://www.yelp.com/biz/sd-drywall-and-insulation-hillsboro", "https://www.yelp.com/biz/salem-drywall-salem", "https://www.yelp.com/biz/ed-masters-vancouver", "https://www.yelp.com/biz/moon-construction-molalla", "https://www.yelp.com/biz/top-caliber-painting-salem", "https://www.yelp.com/biz/willamette-valley-painting-and-construction-lebanon-2", "https://www.yelp.com/biz/sfw-construction-llc-portland-3", "https://www.yelp.com/biz/merit-painting-llc-beaverton", "https://www.yelp.com/biz/kelly-and-sons-painting-salem-2", "https://www.yelp.com/biz/grace-point-contracting-woodburn", "https://www.yelp.com/biz/blended-painting-hillsboro-5", "https://www.yelp.com/biz/haney-construction-salem-2", "https://www.yelp.com/biz/reliance-painting-and-maintenance-portland-2", "https://www.yelp.com/biz/certapro-painters-of-salem-eugene-springfield", "https://www.yelp.com/biz/box-painting-salem", "https://www.yelp.com/biz/cm-painting-and-contracting-hillsboro", "https://www.yelp.com/biz/gary-christian-painting-wood-village-3", "https://www.yelp.com/biz/benitez-painting-and-roofing-albany-3", "https://www.yelp.com/biz/ridge-painting-corbett", "https://www.yelp.com/biz/infinty-construction-salem", "https://www.yelp.com/biz/custom-coat-painting-dallas-4", "https://www.yelp.com/biz/unity-services-painting-and-more-portland-3", "https://www.yelp.com/biz/belart-construction-salem", "https://www.yelp.com/biz/superior-home-remodeling-salem", "https://www.yelp.com/biz/handyman-todd-salem-2", "https://www.yelp.com/biz/synergy-restoration-and-construction-portland-3", "https://www.yelp.com/biz/cunninghams-painting-sweet-home", "https://www.yelp.com/biz/oregon-excellence-painting-salem", "https://www.yelp.com/biz/akies-sandblasting-and-painting-salem", "https://www.yelp.com/biz/northwest-paintworks-salem-2", "https://www.yelp.com/biz/your-home-painting-salem-3", "https://www.yelp.com/biz/c-and-s-residential-painting-salem-2", "https://www.yelp.com/biz/leupitz-contractors-salem", "https://www.yelp.com/biz/elviss-painting-salem", "https://www.yelp.com/biz/v-royal-t-property-services-vancouver", "https://www.yelp.com/biz/apex-paint-and-remodel-salem", "https://www.yelp.com/biz/casa-bella-painting-salem", "https://www.yelp.com/biz/accurate-handyman-and-tree-service-canby", "https://www.yelp.com/biz/titans-painting-salem", "https://www.yelp.com/biz/allwaze-painting-salem", "https://www.yelp.com/biz/als-drywall-salem", "https://www.yelp.com/biz/proline-construction-and-remodel-corvallis-2", "https://www.yelp.com/biz/college-pro-painters-salem", "https://www.yelp.com/biz/jay-tracy-painting-sandy-4", "https://www.yelp.com/biz/nw-monarch-exteriors-portland", "https://www.yelp.com/biz/a-stroke-above-painting-and-construction-salem", "https://www.yelp.com/biz/mighty-movers-and-more-mcminnville", "https://www.yelp.com/biz/aguilas-repaint-salem", "https://www.yelp.com/biz/fitzpatrick-painting-albany-2", "https://www.yelp.com/biz/kd-and-painting-salem", "https://www.yelp.com/biz/telles-painting-newberg-3", "https://www.yelp.com/biz/matrix-painting-woodburn", "https://www.yelp.com/biz/a-plus-builders-salem-2", "https://www.yelp.com/biz/montes-maintenance-salem-7", "https://www.yelp.com/biz/a-plus-builders-portland-4", "https://www.yelp.com/biz/elliott-painting-oregon-city", "https://www.yelp.com/biz/nw-columbia-construction-services-tualatin", "https://www.yelp.com/biz/mcclinton-painting-albany", "https://www.yelp.com/biz/aqb-premier-construction-albany-3", "https://www.yelp.com/biz/night-and-day-painting-dallas-2", "https://www.yelp.com/biz/rey-painting-wilsonville", "https://www.yelp.com/biz/andrade-general-contractors-clackamas", "https://www.yelp.com/biz/cr-waterproofing-albany", "https://www.yelp.com/biz/transfer-hands-vancouver-7", "https://www.yelp.com/biz/superior-refinishing-northwest-portland", "https://www.yelp.com/biz/revive-exteriors-woodburn", "https://www.yelp.com/biz/a-and-s-construction-portland", "https://www.yelp.com/biz/paliy-construction-vancouver-4", "https://www.yelp.com/biz/westland-home-construction-salem", "https://www.yelp.com/biz/preferred-building-contractors-salem", "https://www.yelp.com/biz/advent-contracting-portland-2", "https://www.yelp.com/biz/klockwork-painting-sherwood", "https://www.yelp.com/biz/redline-painting-canby", "https://www.yelp.com/biz/lifetime-exteriors-vancouver", "https://www.yelp.com/biz/accurate-painting-and-pressure-washing-salem", "https://www.yelp.com/biz/proper-t-facelift-salem", "https://www.yelp.com/biz/r-and-m-painting-and-pressure-wash-salem", "https://www.yelp.com/biz/hlebechuk-painting-corvallis-3", "https://www.yelp.com/biz/fivestar-construction-llc-keizer", "https://www.yelp.com/biz/nw-mbs-construction-salem", "https://www.yelp.com/biz/luis-pedro-huber-painting-amity", "https://www.yelp.com/biz/custom-construction-and-concrete-springfield-2", "https://www.yelp.com/biz/american-mastercraft-vancouver", "https://www.yelp.com/biz/clemmens-painting-portland", "https://www.yelp.com/biz/jc-remodel-and-construction-salem-3", "https://www.yelp.com/biz/pj-s-precision-painting-albany", "https://www.yelp.com/biz/insight-home-renovation-canby", "https://www.yelp.com/biz/tualatin-valley-painting-and-construction-portland-8", "https://www.yelp.com/biz/west-coast-roofing-and-painting-portland-5", "https://www.yelp.com/biz/elements-construction-and-remodeling-salem-2", "https://www.yelp.com/biz/gale-family-contracting-beaverton-2", "https://www.yelp.com/biz/eagle-eye-painting-salem", "https://www.yelp.com/biz/g-a-painting-woodburn", "https://www.yelp.com/biz/westcoast-materials-and-construction-salem-2", "https://www.yelp.com/biz/v-a-and-sons-construction-turner", "https://www.yelp.com/biz/handy-folks-eugene-2", "https://www.yelp.com/biz/sfw-painting-portland-2", "https://www.yelp.com/biz/advanced-painting-solutions-salem", "https://www.yelp.com/biz/cuellart-painting-salem-2", "https://www.yelp.com/biz/jh-crown-general-contractor-portland"
]

for profile_url in profile_urls:
    business_urls = extract_business_url(profile_url)

    if business_urls:
        for url in business_urls:
            print(f'"{url}",')






