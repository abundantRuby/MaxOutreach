import requests
from bs4 import BeautifulSoup
from urllib.parse import urlparse, unquote

def extract_business_url(profile_url):
    try:
        response = requests.get(profile_url)
        response.raise_for_status()  # Raise an HTTPError for bad responses
    except requests.exceptions.RequestException as e:
        print(f"Error making request to {profile_url}: {e}")
        return []

    soup = BeautifulSoup(response.text, 'html.parser')

    # Select all links with href starting with "/biz_redir"
    business_links = soup.select('[href^="/biz_redir"]')

    business_urls = set()
    for business_link in business_links:
        href = business_link.get('href')
        # Parse the href to get the actual business URL and remove unwanted text
        parsed_url = urlparse(href)
        business_url = unquote(parsed_url.query.split('=')[1]).split('&')[0]
        business_urls.add(business_url)

    return list(business_urls)

# Example usage with a list of profile URLs
profile_urls = [
    "https://www.yelp.com/biz/cunninghams-painting-sweet-home", "https://www.yelp.com/biz/reliance-painting-and-maintenance-portland-2", "https://www.yelp.com/biz/sfw-construction-llc-portland-3", "https://www.yelp.com/biz/castleberry-painting-junction-city", "https://www.yelp.com/biz/checkmark-painting-springfield", "https://www.yelp.com/biz/pacific-bath-portland", "https://www.yelp.com/biz/stom-painters-albany", "https://www.yelp.com/biz/n-w-precision-exteriors-silverton", "https://www.yelp.com/biz/ethan-darcey-painting-salem", "https://www.yelp.com/biz/home-team-construction-and-remodeling-eugene", "https://www.yelp.com/biz/top-dawg-painting-corvallis", "https://www.yelp.com/biz/bullfrog-painting-corvallis", "https://www.yelp.com/biz/willamette-valley-painting-and-construction-lebanon-2", "https://www.yelp.com/biz/renewal-painting-corvallis", "https://www.yelp.com/biz/marlons-painting-corvallis", "https://www.yelp.com/biz/cr-waterproofing-albany", "https://www.yelp.com/biz/equilibrium-painting-corvallis", "https://www.yelp.com/biz/chalio-fast-pro-construction-albany-2", "https://www.yelp.com/biz/salem-drywall-salem", "https://www.yelp.com/biz/mcneeley-mark-painting-corvallis", "https://www.yelp.com/biz/night-and-day-painting-dallas-2", "https://www.yelp.com/biz/spades-environmental-and-construction-springfield", "https://www.yelp.com/biz/pj-s-precision-painting-albany", "https://www.yelp.com/biz/infinty-construction-salem", "https://www.yelp.com/biz/creative-solutions-painting-springfield", "https://www.yelp.com/biz/all-purpose-painting-and-more-eugene", "https://www.yelp.com/biz/colortech-enterprises-mount-angel", "https://www.yelp.com/biz/lidias-painting-and-remodeling-corvallis", "https://www.yelp.com/biz/new-day-painting-mcminnville-3", "https://www.yelp.com/biz/custom-construction-and-concrete-springfield-2", "https://www.yelp.com/biz/custom-coat-painting-dallas-4", "https://www.yelp.com/biz/mcclinton-painting-albany", "https://www.yelp.com/biz/aguilas-repaint-salem", "https://www.yelp.com/biz/hlebechuk-painting-corvallis-3", "https://www.yelp.com/biz/michael-angelo-exteriors-salem-3", "https://www.yelp.com/biz/nw-mbs-construction-salem", "https://www.yelp.com/biz/benitez-painting-and-roofing-albany-3", "https://www.yelp.com/biz/bov-elite-painting-eugene-4", "https://www.yelp.com/biz/belart-construction-salem", "https://www.yelp.com/biz/college-works-painting-corvallis-2", "https://www.yelp.com/biz/oregon-excellence-painting-salem", "https://www.yelp.com/biz/proline-construction-and-remodel-corvallis-2", "https://www.yelp.com/biz/handyman-todd-salem-2", "https://www.yelp.com/biz/superior-home-remodeling-salem", "https://www.yelp.com/biz/valley-roof-care-corvallis-2", "https://www.yelp.com/biz/halcyon-painting-corvallis", "https://www.yelp.com/biz/fitzpatrick-painting-albany-2", "https://www.yelp.com/biz/certapro-painters-of-salem-eugene-springfield", "https://www.yelp.com/biz/monty-jackson-painting-redding", "https://www.yelp.com/biz/eagle-eye-painting-redding", "https://www.yelp.com/biz/napa-valley-painting-napa", "https://www.yelp.com/biz/allstate-painting-magalia", "https://www.yelp.com/biz/j-d-and-son-painting-redding", "https://www.yelp.com/biz/rj-painting-and-decorating-orland", "https://www.yelp.com/biz/hovey-painting-and-decorating-redding", "https://www.yelp.com/biz/scotts-painting-cottonwood", "https://www.yelp.com/biz/generation-three-painting-chico", "https://www.yelp.com/biz/professional-coatings-redding", "https://www.yelp.com/biz/mike-samuelsen-painting-chico-3", "https://www.yelp.com/biz/nielsens-painting-restoration-and-wood-finishing-chico-4", "https://www.yelp.com/biz/eikland-s-skilled-trade-handyman-services-redding-6", "https://www.yelp.com/biz/professional-painting-redding-2", "https://www.yelp.com/biz/rc-home-repairs-redding", "https://www.yelp.com/biz/sgb-custom-painting-chico", "https://www.yelp.com/biz/jeff-loughmiller-painting-chico", "https://www.yelp.com/biz/cardan-aircraft-painting-red-bluff", "https://www.yelp.com/biz/mcnabb-painting-and-wallcovering-san-ramon-2", "https://www.yelp.com/biz/empire-painting-redding", "https://www.yelp.com/biz/just-duckey-painting-redding-2", "https://www.yelp.com/biz/trinity-handyman-services-lewiston", "https://www.yelp.com/biz/sm-painting-chico", "https://www.yelp.com/biz/paint-broz-cottonwood-2", "https://www.yelp.com/biz/jesses-superior-painting-grants-pass", "https://www.yelp.com/biz/equitz-painting-white-city", "https://www.yelp.com/biz/mcnabb-painting-and-wallcovering-san-ramon-2", "https://www.yelp.com/biz/randy-johnson-painting-and-cr-cy-crescent-city", "https://www.yelp.com/biz/plunkett-family-painting-crescent-city", "https://www.yelp.com/biz/napa-valley-painting-napa", "https://www.yelp.com/biz/new-effex-painting-and-decorating-crescent-city", "https://www.yelp.com/biz/thomas-serna-and-sons-weatherking-painting-and-repairs-brookings", "https://www.yelp.com/biz/a-heating-and-painting-gold-beach", "https://www.yelp.com/biz/jc-painting-and-services-brookings", "https://www.yelp.com/biz/gb-home-improvement-medford-2", "https://www.yelp.com/biz/bb-painting-and-construction-brookings", "https://www.yelp.com/biz/golden-crest-painting-redding", "https://www.yelp.com/biz/nielsens-painting-restoration-and-wood-finishing-chico-4", "https://www.yelp.com/biz/trinity-handyman-services-lewiston", "https://www.yelp.com/biz/just-duckey-painting-redding-2", "https://www.yelp.com/biz/professional-painting-redding-2", "https://www.yelp.com/biz/ronald-construction-anderson-3", "https://www.yelp.com/biz/sierra-painting-shasta-lake", "https://www.yelp.com/biz/generation-three-painting-chico", "https://www.yelp.com/biz/the-paint-smith-shasta-lake", "https://www.yelp.com/biz/lmnt-painting-redding", "https://www.yelp.com/biz/catalano-dan-and-son-painting-redding", "https://www.yelp.com/biz/hovey-painting-and-decorating-redding", "https://www.yelp.com/biz/modern-painting-redding-2", "https://www.yelp.com/biz/dodds-painting-redding", "https://www.yelp.com/biz/eagle-eye-painting-redding", "https://www.yelp.com/biz/rc-home-repairs-redding", "https://www.yelp.com/biz/harris-painting-shasta-lake-2", "https://www.yelp.com/biz/breach-builders-international-redding", "https://www.yelp.com/biz/professional-coatings-redding", "https://www.yelp.com/biz/hampton-painting-anderson", "https://www.yelp.com/biz/advanced-coatings-redding", "https://www.yelp.com/biz/barnes-painting-redding", "https://www.yelp.com/biz/apro2call-enterprises-redding-5", "https://www.yelp.com/biz/ron-harmon-painting-redding-2", "https://www.yelp.com/biz/rj-painting-and-decorating-orland", "https://www.yelp.com/biz/napa-valley-painting-napa", "https://www.yelp.com/biz/cut-twice-remodeling-redding", "https://www.yelp.com/biz/tom-davis-painting-redding", "https://www.yelp.com/biz/talbot-painting-services-redding-2", "https://www.yelp.com/biz/tinos-painting-redding", "https://www.yelp.com/biz/ron-harmon-painting-redding", "https://www.yelp.com/biz/eikland-s-skilled-trade-handyman-services-redding-6", "https://www.yelp.com/biz/anderson-painting-cottonwood", "https://www.yelp.com/biz/carlsons-painting-palo-cedro", "https://www.yelp.com/biz/inspire-painting-redding", "https://www.yelp.com/biz/mandaches-painting-redding", "https://www.yelp.com/biz/terry-painting-redding", "https://www.yelp.com/biz/craig-miller-painting-redding", "https://www.yelp.com/biz/scotts-painting-cottonwood", "https://www.yelp.com/biz/mcnabb-painting-and-wallcovering-san-ramon-2", "https://www.yelp.com/biz/paint-broz-cottonwood-2", "https://www.yelp.com/biz/david-sieker-painting-anderson", "https://www.yelp.com/biz/monty-jackson-painting-redding", "https://www.yelp.com/biz/curries-quality-painting-redding", "https://www.yelp.com/biz/prc-painting-inc-redding", "https://www.yelp.com/biz/j-d-and-son-painting-redding", "https://www.yelp.com/biz/walgamuth-painting-redding", "https://www.yelp.com/biz/handycan-redding-4", "https://www.yelp.com/biz/stephens-painting-redding", "https://www.yelp.com/biz/stanley-painting-and-coatings-cottonwood-2", "https://www.yelp.com/biz/4-seasons-painting-redding", "https://www.yelp.com/biz/tyree-painting-redding-2", "https://www.yelp.com/biz/empire-painting-redding"
]

for profile_url in profile_urls:
    business_urls = extract_business_url(profile_url)

    if business_urls:
        for url in business_urls:
            print(f'"{url}",')







