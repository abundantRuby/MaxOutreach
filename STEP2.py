import requests
from bs4 import BeautifulSoup
from urllib.parse import urlparse, unquote

def extract_business_url(profile_url):
    try:
        response = requests.get(profile_url)
        response.raise_for_status()  # Raise an HTTPError for bad responses
    except requests.exceptions.RequestException as e:
        print(f"Error making request to {profile_url}: {e}")
        return []

    soup = BeautifulSoup(response.text, 'html.parser')

    # Select all links with href starting with "/biz_redir"
    business_links = soup.select('[href^="/biz_redir"]')

    business_urls = set()
    for business_link in business_links:
        href = business_link.get('href')
        # Parse the href to get the actual business URL and remove unwanted text
        parsed_url = urlparse(href)
        business_url = unquote(parsed_url.query.split('=')[1]).split('&')[0]
        business_urls.add(business_url)

    return list(business_urls)

# Example usage with a list of profile URLs
profile_urls = [
    "https://www.yelp.com/biz/reliable-construction-san-francisco-2", "https://www.yelp.com/biz/milks-painters-and-decorators-san-anselmo", "https://www.yelp.com/biz/kavanagh-painting-san-francisco", "https://www.yelp.com/biz/home-quality-remodeling-concord-4", "https://www.yelp.com/biz/charmed-painting-oakland", "https://www.yelp.com/biz/santos-colma-3", "https://www.yelp.com/biz/j-gomez-painting-san-francisco", "https://www.yelp.com/biz/gamaliel-villatoro-painting-san-lorenzo", "https://www.yelp.com/biz/facundo-cruzs-painting-services-oakland-2", "https://www.yelp.com/biz/victoria-painting-and-restoration-san-francisco", "https://www.yelp.com/biz/carlos-construction-daly-city", "https://www.yelp.com/biz/o-and-w-windows-and-doors-installation-san-leandro-2", "https://www.yelp.com/biz/basterra-painting-and-decorating-san-francisco", "https://www.yelp.com/biz/de-martini-arnott-painting-company-san-francisco", "https://www.yelp.com/biz/rj-painting-palo-alto-3", "https://www.yelp.com/biz/jarquin-painting-antioch-5", "https://www.yelp.com/biz/reynaga-s-painting-services-san-jose", "https://www.yelp.com/biz/magic-painting-san-francisco", "https://www.yelp.com/biz/raymundo-painting-vallejo-10", "https://www.yelp.com/biz/gallegos-painting-castro-valley", "https://www.yelp.com/biz/fas-construction-richmond-2", "https://www.yelp.com/biz/pro-painting-cali-oakland", "https://www.yelp.com/biz/ramos-painting-san-mateo", "https://www.yelp.com/biz/magic-touch-painting-company-san-francisco", "https://www.yelp.com/biz/palladino-painting-half-moon-bay", "https://www.yelp.com/biz/feregrino-electric-richmond-2", "https://www.yelp.com/biz/bobby-the-painter-pacifica", "https://www.yelp.com/biz/marcio-s-painting-san-francisco", "https://www.yelp.com/biz/the-wright-way-painting-vacaville", "https://www.yelp.com/biz/handy-home-services-hercules-3", "https://www.yelp.com/biz/lucas-painting-san-francisco", "https://www.yelp.com/biz/craft-team-palo-alto", "https://www.yelp.com/biz/pacific-star-construction-and-painting-san-francisco", "https://www.yelp.com/biz/aarons-painting-vallejo", "https://www.yelp.com/biz/flores-painting-san-francisco", "https://www.yelp.com/biz/patch-wall-fast-san-francisco-2", "https://www.yelp.com/biz/hayward-pro-construction-and-painting-hayward", "https://www.yelp.com/biz/most-creative-painting-redwood-city", "https://www.yelp.com/biz/cartwright-painters-san-jose-2", "https://www.yelp.com/biz/john-bango-handy-installation-and-repair-san-francisco", "https://www.yelp.com/biz/ufc-painting-and-construction-daly-city-2", "https://www.yelp.com/biz/dustin-michel-painting-san-francisco", "https://www.yelp.com/biz/best-deal-painting-sj-san-jose-10", "https://www.yelp.com/biz/barnoski-painting-daly-city", "https://www.yelp.com/biz/jonathan-bassil-painting-novato", "https://www.yelp.com/biz/eaa-services-oakland", "https://www.yelp.com/biz/sierra-painting-fremont-6", "https://www.yelp.com/biz/zaven-daigian-painting-san-francisco-2", "https://www.yelp.com/biz/kennyman-the-handyman-san-francisco-5", "https://www.yelp.com/biz/neals-painting-san-francisco", "https://www.yelp.com/biz/picasso-painting-el-granada", "https://www.yelp.com/biz/bayview-painting-moraga", "https://www.yelp.com/biz/duque-painting-san-leandro", "https://www.yelp.com/biz/tech-painting-san-francisco-5", "https://www.yelp.com/biz/zarich-painting-and-decorating-san-francisco", "https://www.yelp.com/biz/j-and-r-services-concord-2", "https://www.yelp.com/biz/aqpaintingsf-san-francisco", "https://www.yelp.com/biz/san-francisco-painting-company-san-francisco", "https://www.yelp.com/biz/garcia-s-painting-novato-2", "https://www.yelp.com/biz/colorfast-painting-company-san-francisco", "https://www.yelp.com/biz/agustin-brothers-construction-berkeley", "https://www.yelp.com/biz/prosperety-santa-clara", "https://www.yelp.com/biz/a-coatings-antioch-3", "https://www.yelp.com/biz/fresh-coat-painters-sausalito-2", "https://www.yelp.com/biz/beltran-and-son-painting-services-san-francisco", "https://www.yelp.com/biz/paint-studio-sf-san-francisco", "https://www.yelp.com/biz/try-us-painting-san-francisco", "https://www.yelp.com/biz/gorman-tom-painting-and-waterproofing-san-francisco", "https://www.yelp.com/biz/walls-n-beyond-painting-company-san-francisco-3", "https://www.yelp.com/biz/mb-jessee-painting-oakland-4", "https://www.yelp.com/biz/winning-colors-san-francisco", "https://www.yelp.com/biz/tony-sanchez-painting-san-francisco", "https://www.yelp.com/biz/cronin-painting-san-francisco", "https://www.yelp.com/biz/vasquez-painting-san-francisco", "https://www.yelp.com/biz/mccarthy-painting-co-san-rafael", "https://www.yelp.com/biz/house-painter-emer-san-francisco-2", "https://www.yelp.com/biz/hmejiapainting-oakland-2", "https://www.yelp.com/biz/r-and-d-construction-services-san-francisco-4", "https://www.yelp.com/biz/c-h-painting-healdsburg", "https://www.yelp.com/biz/pele-painting-services-hercules", "https://www.yelp.com/biz/wilmar-s-painting-oakland", "https://www.yelp.com/biz/color-touch-painting-san-francisco-2", "https://www.yelp.com/biz/tradesman-painting-and-drywall-novato", "https://www.yelp.com/biz/ad-pro-painting-daly-city-2", "https://www.yelp.com/biz/bruce-bettencourt-painting-company-inc-burlingame-2", "https://www.yelp.com/biz/eddie-morgan-san-francisco", "https://www.yelp.com/biz/certapro-painters-of-berkeley-oakland-6", "https://www.yelp.com/biz/catrux-wallpaper-painting-and-handyman-san-francisco", "https://www.yelp.com/biz/johnny-george-painting-and-decorating-concord", "https://www.yelp.com/biz/golden-colors-painting-richmond-3", "https://www.yelp.com/biz/color-link-painting-company-san-francisco", "https://www.yelp.com/biz/dimensions-painting-oakland-3", "https://www.yelp.com/biz/konrad-and-colson-painting-san-francisco", "https://www.yelp.com/biz/kaiwi-construction-palo-alto-3", "https://www.yelp.com/biz/jb-painting-oakland-2", "https://www.yelp.com/biz/tonys-painting-and-remodeling-fremont-3", "https://www.yelp.com/biz/hilcias-painting-san-francisco", "https://www.yelp.com/biz/handyman-gonzalez-construction-san-francisco-2", "https://www.yelp.com/biz/painting-usa-san-francisco", "https://www.yelp.com/biz/united-painters-san-francisco", "https://www.yelp.com/biz/shine-painting-newark-2", "https://www.yelp.com/biz/lobato-painting-san-francisco", "https://www.yelp.com/biz/fog-town-painters-san-francisco", "https://www.yelp.com/biz/handy-oscar-berkeley-2", "https://www.yelp.com/biz/edy-handyman-san-mateo", "https://www.yelp.com/biz/yuri-construction-san-francisco-2", "https://www.yelp.com/biz/pure-admiration-painting-san-francisco", "https://www.yelp.com/biz/j-thrupp-painting-san-francisco", "https://www.yelp.com/biz/octavio-painting-san-francisco", "https://www.yelp.com/biz/san-francisco-handyman-services-san-francisco", "https://www.yelp.com/biz/watterson-painting-pacifica", "https://www.yelp.com/biz/man-and-a-van-handyman-san-francisco-8", "https://www.yelp.com/biz/daniel-pelaez-painting-san-jose-5", "https://www.yelp.com/biz/rs-painting-concord", "https://www.yelp.com/biz/lopez-painting-san-francisco", "https://www.yelp.com/biz/m-and-l-construction-san-francisco", "https://www.yelp.com/biz/all-united-painting-san-jose-3", "https://www.yelp.com/biz/nave-painting-and-24-hour-handyman-service-st-helena-2", "https://www.yelp.com/biz/aranas-painting-burlingame-3", "https://www.yelp.com/biz/mendez-painting-san-francisco", "https://www.yelp.com/biz/certapro-painters-of-san-francisco-ca-san-francisco", "https://www.yelp.com/biz/stavenger-painting-san-francisco", "https://www.yelp.com/biz/inside-out-painting-san-francisco-3", "https://www.yelp.com/biz/juan-carlos-handyman-san-mateo-4", "https://www.yelp.com/biz/army-painting-gilroy", "https://www.yelp.com/biz/escamillas-painting-newark-9", "https://www.yelp.com/biz/j-and-j-painting-and-handyman-oakland-3", "https://www.yelp.com/biz/24-7-handyman-san-francisco", "https://www.yelp.com/biz/future-general-construction-san-francisco", "https://www.yelp.com/biz/paul-woodford-services-san-francisco", "https://www.yelp.com/biz/stars-painting-san-francisco-4", "https://www.yelp.com/biz/haber-painting-san-francisco", "https://www.yelp.com/biz/steve-the-handyman-san-francisco", "https://www.yelp.com/biz/sorensen-jeff-w-painting-and-decorating-san-francisco", "https://www.yelp.com/biz/hank-garcia-painting-san-francisco", "https://www.yelp.com/biz/mayorga-handyman-services-daly-city-3", "https://www.yelp.com/biz/wah-lo-painting-san-francisco", "https://www.yelp.com/biz/schinman-painting-and-construction-san-francisco"
]

for profile_url in profile_urls:
    business_urls = extract_business_url(profile_url)

    if business_urls:
        for url in business_urls:
            print(f'"{url}",')







